<div class="new">

	<div class="alert alert-warning" role="alert" ng-show="!permissions.write && !permissions['read:public']" sf-decorator-name="'bootstrap-decorator'">
		You are not allowed to see the contents of this stage.
	</div>

	<ul class="nav nav-tabs" role="tablist">
		<li ng-show="permissions.write" ng-class="{active: tab === 'write'}"><a href ng-click="tab = 'write'">Write a Review</a></li>
		<li ng-show="permissions['read:public']" ng-class="{active: tab === 'read'}"><a href ng-click="tab = 'read'">Read Reviews</a></li>
	</ul>

	<div class="panel panel-default">
		<div class="panel-body" ng-show="permissions.write && tab === 'write'">
			<div class="row">
				<div class="col-sm-6">
					<h2>Content</h2>
					<select ng-show="options.preview.length > 1" class="form-control" ng-model="write.preview" ng-options="v as context.cycle.flow[v].title for (k, v) in options.preview"></select>
					<div class="well">
						<div gandhi-component="{cycle: context.cycle, project: context.project, stage: write.preview, role: context.role, mode: 'default'}"></div>
					</div>
				</div>
				<div class="col-sm-6">
					<h2>Review</h2>
					<form name="gandhiComponentReview" ng-submit="write.submit(gandhiComponentReview, data)">
						<div sf-model="write.review.data" sf-form="options.form" sf-schema="options.schema" sf-options="{}"></div>
						<div ng-show="permissions.write" ng-click="write.save()" class="btn btn-default" ng-bind="options.draftButtonText || 'Save Draft'"></div>
						<button ng-show="permissions.write" class="btn btn-primary" ng-bind="options.submitButtonText || 'Submit'"></button>
					</form>
				</div>
			</div>
		</div>
		<div class="panel-body" ng-show="permissions['read:public'] && tab === 'read'">
			<div class="row">
				<div class="col-sm-3">
					<ul class="nav nav-pills nav-stacked">
						<li ng-class="{active: read.group.key == group.key}" ng-repeat="group in read.groups"><a href ng-bind="group.title" ng-click="read.group = group"></a></li>
					</ul>
				</div>
				<div class="col-sm-9" ng-if="read.group">
					<div ng-repeat="review in read.group.data">
						<form sf-model="review.data" sf-form="read.group.form" sf-schema="options.schema" sf-options="read.config"></form>
					</div>
				</div>
			</div>
		</div>
	</div>

</div>